#!/bin/bash
## Step 1: Configure OBS Repository
##(as user root, only once)

#echo "deb http://download.opensuse.org/repositories/security:/OpenVAS:/UNSTABLE:/v5/Debian_6.0/ ./" >> /etc/apt/sources.list
#apt-key adv --keyserver hkp://keys.gnupg.net --recv-keys BED1E87979EAFD54
#apt-get update

##Step 2: Quick-Install OpenVAS
##(as user root, only once)

apt-get -y install greenbone-security-assistant gsd openvas-cli openvas-manager openvas-scanner openvas-administrator sqlite3 xsltproc

##To install support packages for report generation (downloads around 30 MB of additional packages):

apt-get -y install texlive-latex-base texlive-latex-extra texlive-latex-recommended htmldoc

##To install support for autogenerated LSC credential packages:

apt-get -y install alien rpm nsis fakeroot

##Step 3: Quick-Start OpenVAS
##(copy and paste whole block as user root, during first time you will be asked to set a password for user "admin")

test -e /var/lib/openvas/CA/cacert.pem  || openvas-mkcert -q
openvas-nvt-sync
test -e /var/lib/openvas/users/om || openvas-mkcert-client -n om -i
/etc/init.d/openvas-manager stop 
/etc/init.d/openvas-scanner stop 
openvassd
openvasmd --migrate
openvasmd --rebuild
killall openvassd
sleep 15
/etc/init.d/openvas-scanner start
/etc/init.d/openvas-manager start
/etc/init.d/openvas-administrator restart
/etc/init.d/greenbone-security-assistant restart
test -e /var/lib/openvas/users/admin || openvasad -c add_user -n admin -r Admin

